<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Software Ontwikkeling: migrate-v2-to-v3</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="placeholder.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Software Ontwikkeling
   &#160;<span id="projectnumber">0</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">migrate-v2-to-v3 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="top"></a> </p>
<h1><a class="anchor" id="autotoc_md218"></a>
Migrating from v2 to v3</h1>
<p>v3 is the next major version of Catch2 and brings three significant changes:</p><ul>
<li>Catch2 is now split into multiple headers</li>
<li>Catch2 is now compiled as a static library</li>
<li>C++14 is the minimum required C++ version</li>
</ul>
<p>There are many reasons why we decided to go from the old single-header distribution model to a more standard library distribution model. The big one is compile-time performance, but moving over to a split header distribution model also improves the future maintainability and extendability of the codebase. For example v3 adds a new kind of matchers without impacting the compilation times of users that do not use matchers in their tests. The new model is also more friendly towards package managers, such as vcpkg and Conan.</p>
<p>The result of this move is a significant improvement in compilation times, e.g. the inclusion overhead of Catch2 in the common case has been reduced by roughly 80%. The improved ease of maintenance also led to various runtime performance improvements and the introduction of new features. For details, look at <a href="release-notes.md#301">the release notes of 3.0.1</a>.</p>
<p><em>Note that we still provide one header + one translation unit (TU) distribution but do not consider it the primarily supported option. You should also expect that the compilation times will be worse if you use this option.</em></p>
<h2><a class="anchor" id="autotoc_md219"></a>
How to migrate projects from v2 to v3</h2>
<p>To migrate to v3, there are two basic approaches to do so.</p>
<ol type="1">
<li>Use <code><a class="el" href="catch__amalgamated_8hpp.html">catch_amalgamated.hpp</a></code> and <code><a class="el" href="catch__amalgamated_8cpp.html">catch_amalgamated.cpp</a></code>.</li>
<li>Build Catch2 as a proper (static) library, and move to piecewise headers</li>
</ol>
<p>Doing 1 means downloading the <a href="/extras/catch_amalgamated.hpp">amalgamated header</a> and the <a href="/extras/catch_amalgamated.cpp">amalgamated sources</a> from <code>extras</code>, dropping them into your test project, and rewriting your includes from <code>&lt;catch2/catch.hpp&gt;</code> to <code>"catch_amalgamated.hpp"</code> (or something similar, based on how you set up your paths).</p>
<p>The disadvantage of using this approach are increased compilation times, at least compared to the second approach, but it does let you avoid dealing with consuming libraries in your build system of choice.</p>
<p>However, we recommend doing 2, and taking extra time to migrate to v3 properly. This lets you reap the benefits of significantly improved compilation times in the v3 version. The basic steps to do so are:</p>
<ol type="1">
<li>Change your CMakeLists.txt to link against <code>Catch2WithMain</code> target if you use Catch2's default main. (If you do not, keep linking against the <code>Catch2</code> target.). If you use pkg-config, change <code>pkg-config catch2</code> to <code>pkg-config catch2-with-main</code>.</li>
<li>Delete TU with <code>CATCH_CONFIG_RUNNER</code> or <code>CATCH_CONFIG_MAIN</code> defined, as it is no longer needed.</li>
<li>Change <code>#include &lt;catch2/catch.hpp&gt;</code> to <code>#include &lt;<a class="el" href="catch__all_8hpp.html">catch2/catch_all.hpp</a>&gt;</code></li>
<li>Check that everything compiles. You might have to modify namespaces, or perform some other changes (see the <a href="#things-that-can-break-during-porting">Things that can break during porting</a> section for the most common things).</li>
<li>Start migrating your test TUs from including <code>&lt;<a class="el" href="catch__all_8hpp.html">catch2/catch_all.hpp</a>&gt;</code> to piecemeal includes. You will likely want to start by including <code>&lt;<a class="el" href="catch__test__macros_8hpp.html">catch2/catch_test_macros.hpp</a>&gt;</code>, and then go from there. (see <a href="#other-notes">other notes</a> for further ideas)</li>
</ol>
<h2><a class="anchor" id="autotoc_md220"></a>
Other notes</h2>
<ul>
<li>The main test include is now <code>&lt;<a class="el" href="catch__test__macros_8hpp.html">catch2/catch_test_macros.hpp</a>&gt;</code></li>
<li>Big "subparts" like Matchers, or Generators, have their own folder, and also their own "big header", so if you just want to include all matchers, you can include <code>&lt;<a class="el" href="catch__matchers__all_8hpp.html">catch2/matchers/catch_matchers_all.hpp</a>&gt;</code>, or <code>&lt;<a class="el" href="catch__generators__all_8hpp.html">catch2/generators/catch_generators_all.hpp</a>&gt;</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md221"></a>
Things that can break during porting</h2>
<ul>
<li>The namespaces of Matchers were flattened and cleaned up.</li>
</ul>
<p>Matchers are no longer declared deep within an internal namespace and then brought up into <code><a class="el" href="namespaceCatch.html">Catch</a></code> namespace. All Matchers now live in the <code><a class="el" href="namespaceCatch_1_1Matchers.html">Catch::Matchers</a></code> namespace.</p>
<ul>
<li>The <code>Contains</code> string matcher was renamed to <code>ContainsSubstring</code>.</li>
<li>The reporter interfaces changed in a breaking manner.</li>
</ul>
<p>If you are using a custom reporter or listener, you will likely need to modify them to conform to the new interfaces. Unlike before in v2, the <a href="reporters.md#top">interfaces</a> and the <a href="reporter-events.md#top">events</a> are now documented.</p>
<hr  />
<p><a href="Readme.md#top">Home</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
